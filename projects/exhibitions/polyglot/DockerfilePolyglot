FROM haskell:8
LABEL maintainer="Harry Watkinson <w.h.watkinson@gmail.com>"

ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get update -y && \
    apt-get install -y \
    gcc \
    g++ \
    fish \
    default-jdk \
    perl \
    php \
    python2 \
    python3 \
    ruby-full \
    tcl \
    zsh

RUN apt-get update -y && \
    apt-get install -y \
    curl \
    git \
    make \
    maven \
    wget

# Nim
RUN wget https://nim-lang.org/download/nim-1.6.10-linux_x64.tar.xz && \
    tar -xJf nim-1.6.10-linux_x64.tar.xz && \
    rm nim-1.6.10-linux_x64.tar.xz && \
    mv /nim-1.6.10/ /usr/lib/
ENV PATH=/usr/lib/nim-1.6.10/bin:$PATH

# Tea
#WORKDIR /usr/lib
#RUN git clone https://github.com/jorgefranconunes/tea.git && \
#    cd tea/modules && \
#    mvn -DskipTests=false
#ENV PATH=$PATH:/usr/lib/tea/bin

# Rust
RUN curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
ENV PATH=/root/.cargo/bin:$PATH

# Coffeescript
RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - && \
    apt-get update -y && \
    apt-get install -y \
    nodejs && \
    npm install -g npm@latest && \
    npm update -g npm && \
    npm install coffeescript -g

# julia
RUN wget https://julialang-s3.julialang.org/bin/linux/x64/1.8/julia-1.8.1-linux-x86_64.tar.gz && \
    tar -xzf julia-1.8.1-linux-x86_64.tar.gz && \
    rm julia-1.8.1-linux-x86_64.tar.gz && \
    mv julia-1.8.1 /usr/lib/
ENV PATH=$PATH:/usr/lib/julia-1.8.1/bin

# ADGA
RUN cabal update && \
    cabal install Agda


WORKDIR /usr/project
COPY main.c .
COPY run.sh .
RUN chmod +x run.sh
RUN nim compile main.c

# TODO agda, objective-c, Brainf***, Haskell, php, Raku, tea

#CMD ["./run.sh"]
CMD ["tail", "-f", "/dev/null"]
